import{x as y,L as B,M as F}from"./useFocusRing-CVnp8mQS.js";import{r as l}from"./index-D4lIrffr.js";function z(e,t,a){let o=l.useRef(t),s=y(()=>{a&&a(o.current)});l.useEffect(()=>{var r;let i=e==null||(r=e.current)===null||r===void 0?void 0:r.form;return i==null||i.addEventListener("reset",s),()=>{i==null||i.removeEventListener("reset",s)}},[e,s])}function G(e,t,a){let[o,s]=l.useState(e||t),r=l.useRef(e!==void 0),i=e!==void 0;l.useEffect(()=>{r.current,r.current=i},[i]);let c=i?e:o,d=l.useCallback((n,...v)=>{let f=(m,...$)=>{a&&(Object.is(c,m)||a(m,...$)),i||(c=m)};typeof n=="function"?s(($,...p)=>{let V=n(i?c:$,...p);return f(V,...v),i?$:V}):(i||s(n),f(n,...v))},[i,c,a]);return[c,d]}const A={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},w={...A,customError:!0,valid:!1},b={isInvalid:!1,validationDetails:A,validationErrors:[]},T=l.createContext({}),C="__formValidationState"+Date.now();function H(e){if(e[C]){let{realtimeValidation:t,displayValidation:a,updateValidation:o,resetValidation:s,commitValidation:r}=e[C];return{realtimeValidation:t,displayValidation:a,updateValidation:o,resetValidation:s,commitValidation:r}}return U(e)}function U(e){let{isInvalid:t,validationState:a,name:o,value:s,builtinValidation:r,validate:i,validationBehavior:c="aria"}=e;a&&(t||(t=a==="invalid"));let d=t!==void 0?{isInvalid:t,validationErrors:[],validationDetails:w}:null,n=l.useMemo(()=>{if(!i||s==null)return null;let u=_(i,s);return D(u)},[i,s]);r!=null&&r.validationDetails.valid&&(r=void 0);let v=l.useContext(T),f=l.useMemo(()=>o?Array.isArray(o)?o.flatMap(u=>S(v[u])):S(v[o]):[],[v,o]),[m,$]=l.useState(v),[p,V]=l.useState(!1);v!==m&&($(v),V(!1));let g=l.useMemo(()=>D(p?[]:f),[p,f]),L=l.useRef(b),[h,M]=l.useState(b),E=l.useRef(b),R=()=>{if(!O)return;I(!1);let u=n||r||L.current;x(u,E.current)||(E.current=u,M(u))},[O,I]=l.useState(!1);return l.useEffect(R),{realtimeValidation:d||g||n||r||b,displayValidation:c==="native"?d||g||h:d||g||n||r||h,updateValidation(u){c==="aria"&&!x(h,u)?M(u):L.current=u},resetValidation(){let u=b;x(u,E.current)||(E.current=u,M(u)),c==="native"&&I(!1),V(!0)},commitValidation(){c==="native"&&I(!0),V(!0)}}}function S(e){return e?Array.isArray(e)?e:[e]:[]}function _(e,t){if(typeof e=="function"){let a=e(t);if(a&&typeof a!="boolean")return S(a)}return[]}function D(e){return e.length?{isInvalid:!0,validationErrors:e,validationDetails:w}:null}function x(e,t){return e===t?!0:!!e&&!!t&&e.isInvalid===t.isInvalid&&e.validationErrors.length===t.validationErrors.length&&e.validationErrors.every((a,o)=>a===t.validationErrors[o])&&Object.entries(e.validationDetails).every(([a,o])=>t.validationDetails[a]===o)}function J(e,t,a){let{validationBehavior:o,focus:s}=e;B(()=>{if(o==="native"&&(a!=null&&a.current)&&!a.current.disabled){let d=t.realtimeValidation.isInvalid?t.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";a.current.setCustomValidity(d),a.current.hasAttribute("title")||(a.current.title=""),t.realtimeValidation.isInvalid||t.updateValidation(k(a.current))}});let r=y(()=>{t.resetValidation()}),i=y(d=>{var n;t.displayValidation.isInvalid||t.commitValidation();let v=a==null||(n=a.current)===null||n===void 0?void 0:n.form;if(!d.defaultPrevented&&a&&v&&Q(v)===a.current){var f;s?s():(f=a.current)===null||f===void 0||f.focus(),F("keyboard")}d.preventDefault()}),c=y(()=>{t.commitValidation()});l.useEffect(()=>{let d=a==null?void 0:a.current;if(!d)return;let n=d.form;return d.addEventListener("invalid",i),d.addEventListener("change",c),n==null||n.addEventListener("reset",r),()=>{d.removeEventListener("invalid",i),d.removeEventListener("change",c),n==null||n.removeEventListener("reset",r)}},[a,i,c,r,o])}function j(e){let t=e.validity;return{badInput:t.badInput,customError:t.customError,patternMismatch:t.patternMismatch,rangeOverflow:t.rangeOverflow,rangeUnderflow:t.rangeUnderflow,stepMismatch:t.stepMismatch,tooLong:t.tooLong,tooShort:t.tooShort,typeMismatch:t.typeMismatch,valueMissing:t.valueMissing,valid:t.valid}}function k(e){return{isInvalid:!e.validity.valid,validationDetails:j(e),validationErrors:e.validationMessage?[e.validationMessage]:[]}}function Q(e){for(let t=0;t<e.elements.length;t++){let a=e.elements[t];if(!a.validity.valid)return a}return null}const K=l.createContext(null);export{z as $,H as a,J as b,C as c,G as d,b as e,K as f};
