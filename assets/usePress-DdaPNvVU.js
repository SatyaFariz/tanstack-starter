import{o as ce,p as ue,q as Y,r as de,s as te,t as re,u as K,v as pe,w as ve,x as h,y as $e,z as ye,A as g,B as y,C as ge,D as be,a as ne,E as Pe,F as Te,G as Ee,H as W}from"./useFocusRing-BZ3FjUyO.js";import{R as me,r as w}from"./index-D4lIrffr.js";import{r as he}from"./index-DsJinFGm.js";function U(t,s,a=!0){var o,f;let{metaKey:v,ctrlKey:$,altKey:d,shiftKey:T}=s;ce()&&(!((f=window.event)===null||f===void 0||(o=f.type)===null||o===void 0)&&o.startsWith("key"))&&t.target==="_blank"&&(Y()?v=!0:$=!0);let E=ue()&&Y()&&!de()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:v,ctrlKey:$,altKey:d,shiftKey:T}):new MouseEvent("click",{metaKey:v,ctrlKey:$,altKey:d,shiftKey:T,bubbles:!0,cancelable:!0});U.isOpening=a,te(t),t.dispatchEvent(E),U.isOpening=!1}U.isOpening=!1;he();let _="default",G="",A=new WeakMap;function xe(t){if(re()){if(_==="default"){const s=K(t);G=s.documentElement.style.webkitUserSelect,s.documentElement.style.webkitUserSelect="none"}_="disabled"}else if(t instanceof HTMLElement||t instanceof SVGElement){let s="userSelect"in t.style?"userSelect":"webkitUserSelect";A.set(t,t.style[s]),t.style[s]="none"}}function j(t){if(re()){if(_!=="disabled")return;_="restoring",setTimeout(()=>{pe(()=>{if(_==="restoring"){const s=K(t);s.documentElement.style.webkitUserSelect==="none"&&(s.documentElement.style.webkitUserSelect=G||""),G="",_="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&A.has(t)){let s=A.get(t),a="userSelect"in t.style?"userSelect":"webkitUserSelect";t.style[a]==="none"&&(t.style[a]=s),t.getAttribute("style")===""&&t.removeAttribute("style"),A.delete(t)}}const se=me.createContext({register:()=>{}});se.displayName="PressResponderContext";function Se(t,s){return s.get?s.get.call(t):s.value}function ie(t,s,a){if(!s.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return s.get(t)}function ke(t,s){var a=ie(t,s,"get");return Se(t,a)}function we(t,s){if(s.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,s,a){we(t,s),s.set(t,a)}function _e(t,s,a){if(s.set)s.set.call(t,a);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=a}}function q(t,s,a){var o=ie(t,s,"set");return _e(t,o,a),a}function Ie(t){let s=w.useContext(se);if(s){let{register:a,...o}=s;t=ne(o,t),a()}return Pe(s,t.ref),t}var L=new WeakMap;class D{continuePropagation(){q(this,L,!1)}get shouldStopPropagation(){return ke(this,L)}constructor(s,a,o,f){Ke(this,L,{writable:!0,value:void 0}),q(this,L,!0);var v;let $=(v=f==null?void 0:f.target)!==null&&v!==void 0?v:o.currentTarget;const d=$==null?void 0:$.getBoundingClientRect();let T,E=0,I,b=null;o.clientX!=null&&o.clientY!=null&&(I=o.clientX,b=o.clientY),d&&(I!=null&&b!=null?(T=I-d.left,E=b-d.top):(T=d.width/2,E=d.height/2)),this.type=s,this.pointerType=a,this.target=o.currentTarget,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.x=T,this.y=E}}const J=Symbol("linkClicked"),Q="react-aria-pressable-style",Z="data-react-aria-pressable";function De(t){let{onPress:s,onPressChange:a,onPressStart:o,onPressEnd:f,onPressUp:v,onClick:$,isDisabled:d,isPressed:T,preventFocusOnPress:E,shouldCancelOnPointerExit:I,allowTextSelectionOnPress:b,ref:H,...oe}=Ie(t),[le,z]=w.useState(!1),S=w.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:C,removeAllGlobalListeners:R}=ve(),M=h((e,i)=>{let u=S.current;if(d||u.didFirePressStart)return!1;let r=!0;if(u.isTriggeringEvent=!0,o){let l=new D("pressstart",i,e);o(l),r=l.shouldStopPropagation}return a&&a(!0),u.isTriggeringEvent=!1,u.didFirePressStart=!0,z(!0),r}),k=h((e,i,u=!0)=>{let r=S.current;if(!r.didFirePressStart)return!1;r.didFirePressStart=!1,r.isTriggeringEvent=!0;let l=!0;if(f){let n=new D("pressend",i,e);f(n),l=n.shouldStopPropagation}if(a&&a(!1),z(!1),s&&u&&!d){let n=new D("press",i,e);s(n),l&&(l=n.shouldStopPropagation)}return r.isTriggeringEvent=!1,l}),O=h((e,i)=>{let u=S.current;if(d)return!1;if(v){u.isTriggeringEvent=!0;let r=new D("pressup",i,e);return v(r),u.isTriggeringEvent=!1,r.shouldStopPropagation}return!0}),m=h(e=>{let i=S.current;if(i.isPressed&&i.target){i.didFirePressStart&&i.pointerType!=null&&k(x(i.target,e),i.pointerType,!1),i.isPressed=!1,i.isOverTarget=!1,i.activePointerId=null,i.pointerType=null,R(),b||j(i.target);for(let u of i.disposables)u();i.disposables=[]}}),V=h(e=>{I&&m(e)}),F=h(e=>{$==null||$(e)}),N=h((e,i)=>{if($){let u=new MouseEvent("click",e);$e(u,i),$(ye(u))}}),fe=w.useMemo(()=>{let e=S.current,i={onKeyDown(r){if(B(r.nativeEvent,r.currentTarget)&&g(r.currentTarget,y(r.nativeEvent))){var l;ee(y(r.nativeEvent),r.key)&&r.preventDefault();let n=!0;if(!e.isPressed&&!r.repeat){e.target=r.currentTarget,e.isPressed=!0,e.pointerType="keyboard",n=M(r,"keyboard");let c=r.currentTarget,p=P=>{B(P,c)&&!P.repeat&&g(c,y(P))&&e.target&&O(x(e.target,P),"keyboard")};C(K(r.currentTarget),"keyup",Ee(p,u),!0)}n&&r.stopPropagation(),r.metaKey&&Y()&&((l=e.metaKeyEvents)===null||l===void 0||l.set(r.key,r.nativeEvent))}else r.key==="Meta"&&(e.metaKeyEvents=new Map)},onClick(r){if(!(r&&!g(r.currentTarget,y(r.nativeEvent)))&&r&&r.button===0&&!e.isTriggeringEvent&&!U.isOpening){let l=!0;if(d&&r.preventDefault(),!e.ignoreEmulatedMouseEvents&&!e.isPressed&&(e.pointerType==="virtual"||Te(r.nativeEvent))){let n=M(r,"virtual"),c=O(r,"virtual"),p=k(r,"virtual");F(r),l=n&&c&&p}else if(e.isPressed&&e.pointerType!=="keyboard"){let n=e.pointerType||r.nativeEvent.pointerType||"virtual",c=O(x(r.currentTarget,r),n),p=k(x(r.currentTarget,r),n,!0);l=c&&p,e.isOverTarget=!1,F(r),m(r)}e.ignoreEmulatedMouseEvents=!1,l&&r.stopPropagation()}}},u=r=>{var l;if(e.isPressed&&e.target&&B(r,e.target)){var n;ee(y(r),r.key)&&r.preventDefault();let p=y(r),P=g(e.target,y(r));k(x(e.target,r),"keyboard",P),P&&N(r,e.target),R(),r.key!=="Enter"&&X(e.target)&&g(e.target,p)&&!r[J]&&(r[J]=!0,U(e.target,r,!1)),e.isPressed=!1,(n=e.metaKeyEvents)===null||n===void 0||n.delete(r.key)}else if(r.key==="Meta"&&(!((l=e.metaKeyEvents)===null||l===void 0)&&l.size)){var c;let p=e.metaKeyEvents;e.metaKeyEvents=void 0;for(let P of p.values())(c=e.target)===null||c===void 0||c.dispatchEvent(new KeyboardEvent("keyup",P))}};if(typeof PointerEvent<"u"){i.onPointerDown=n=>{if(n.button!==0||!g(n.currentTarget,y(n.nativeEvent)))return;if(ge(n.nativeEvent)){e.pointerType="virtual";return}e.pointerType=n.pointerType;let c=!0;if(!e.isPressed){e.isPressed=!0,e.isOverTarget=!0,e.activePointerId=n.pointerId,e.target=n.currentTarget,b||xe(e.target),c=M(n,e.pointerType);let p=y(n.nativeEvent);"releasePointerCapture"in p&&p.releasePointerCapture(n.pointerId),C(K(n.currentTarget),"pointerup",r,!1),C(K(n.currentTarget),"pointercancel",l,!1)}c&&n.stopPropagation()},i.onMouseDown=n=>{if(g(n.currentTarget,y(n.nativeEvent))&&n.button===0){if(E){let c=be(n.target);c&&e.disposables.push(c)}n.stopPropagation()}},i.onPointerUp=n=>{!g(n.currentTarget,y(n.nativeEvent))||e.pointerType==="virtual"||n.button===0&&!e.isPressed&&O(n,e.pointerType||n.pointerType)},i.onPointerEnter=n=>{n.pointerId===e.activePointerId&&e.target&&!e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!0,M(x(e.target,n),e.pointerType))},i.onPointerLeave=n=>{n.pointerId===e.activePointerId&&e.target&&e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!1,k(x(e.target,n),e.pointerType,!1),V(n))};let r=n=>{if(n.pointerId===e.activePointerId&&e.isPressed&&n.button===0&&e.target){if(g(e.target,y(n))&&e.pointerType!=null){let c=!1,p=setTimeout(()=>{e.isPressed&&e.target instanceof HTMLElement&&(c?m(n):(te(e.target),e.target.click()))},80);C(n.currentTarget,"click",()=>c=!0,!0),e.disposables.push(()=>clearTimeout(p))}else m(n);e.isOverTarget=!1}},l=n=>{m(n)};i.onDragStart=n=>{g(n.currentTarget,y(n.nativeEvent))&&m(n)}}return i},[C,d,E,R,b,m,V,k,M,O,F,N]);return w.useEffect(()=>{if(!H)return;const e=K(H.current);if(!e||!e.head||e.getElementById(Q))return;const i=e.createElement("style");i.id=Q,i.textContent=`
@layer {
  [${Z}] {
    touch-action: pan-x pan-y pinch-zoom;
  }
}
    `.trim(),e.head.prepend(i)},[H]),w.useEffect(()=>{let e=S.current;return()=>{var i;b||j((i=e.target)!==null&&i!==void 0?i:void 0);for(let u of e.disposables)u();e.disposables=[]}},[b]),{isPressed:T||le,pressProps:ne(oe,fe,{[Z]:!0})}}function X(t){return t.tagName==="A"&&t.hasAttribute("href")}function B(t,s){const{key:a,code:o}=t,f=s,v=f.getAttribute("role");return(a==="Enter"||a===" "||a==="Spacebar"||o==="Space")&&!(f instanceof W(f).HTMLInputElement&&!ae(f,a)||f instanceof W(f).HTMLTextAreaElement||f.isContentEditable)&&!((v==="link"||!v&&X(f))&&a!=="Enter")}function x(t,s){let a=s.clientX,o=s.clientY;return{currentTarget:t,shiftKey:s.shiftKey,ctrlKey:s.ctrlKey,metaKey:s.metaKey,altKey:s.altKey,clientX:a,clientY:o}}function Ce(t){return t instanceof HTMLInputElement?!1:t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!X(t)}function ee(t,s){return t instanceof HTMLInputElement?!ae(t,s):Ce(t)}const Me=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function ae(t,s){return t.type==="checkbox"||t.type==="radio"?s===" ":Me.has(t.type)}export{De as $};
