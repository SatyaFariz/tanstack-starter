import{o as ce,p as ue,q as Y,r as de,s as te,t as re,u as K,v as pe,w as ve,x as h,y as $e,z as ye,A as g,B as $,C as ge,D as be,a as ne,E as Pe,F as Te,G as Ee,H as W}from"./useFocusRing-CVnp8mQS.js";import{R as me,r as w}from"./index-D4lIrffr.js";import{r as he}from"./index-DsJinFGm.js";function O(t,s,a=!0){var o,f;let{metaKey:p,ctrlKey:v,altKey:d,shiftKey:T}=s;ce()&&(!((f=window.event)===null||f===void 0||(o=f.type)===null||o===void 0)&&o.startsWith("key"))&&t.target==="_blank"&&(Y()?p=!0:v=!0);let E=ue()&&Y()&&!de()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:p,ctrlKey:v,altKey:d,shiftKey:T}):new MouseEvent("click",{metaKey:p,ctrlKey:v,altKey:d,shiftKey:T,bubbles:!0,cancelable:!0});O.isOpening=a,te(t),t.dispatchEvent(E),O.isOpening=!1}O.isOpening=!1;he();let _="default",G="",A=new WeakMap;function xe(t){if(re()){if(_==="default"){const s=K(t);G=s.documentElement.style.webkitUserSelect,s.documentElement.style.webkitUserSelect="none"}_="disabled"}else if(t instanceof HTMLElement||t instanceof SVGElement){let s="userSelect"in t.style?"userSelect":"webkitUserSelect";A.set(t,t.style[s]),t.style[s]="none"}}function j(t){if(re()){if(_!=="disabled")return;_="restoring",setTimeout(()=>{pe(()=>{if(_==="restoring"){const s=K(t);s.documentElement.style.webkitUserSelect==="none"&&(s.documentElement.style.webkitUserSelect=G||""),G="",_="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&A.has(t)){let s=A.get(t),a="userSelect"in t.style?"userSelect":"webkitUserSelect";t.style[a]==="none"&&(t.style[a]=s),t.getAttribute("style")===""&&t.removeAttribute("style"),A.delete(t)}}const se=me.createContext({register:()=>{}});se.displayName="PressResponderContext";function Se(t,s){return s.get?s.get.call(t):s.value}function ie(t,s,a){if(!s.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return s.get(t)}function ke(t,s){var a=ie(t,s,"get");return Se(t,a)}function we(t,s){if(s.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,s,a){we(t,s),s.set(t,a)}function _e(t,s,a){if(s.set)s.set.call(t,a);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=a}}function q(t,s,a){var o=ie(t,s,"set");return _e(t,o,a),a}function Ie(t){let s=w.useContext(se);if(s){let{register:a,...o}=s;t=ne(o,t),a()}return Pe(s,t.ref),t}var U=new WeakMap;class D{continuePropagation(){q(this,U,!1)}get shouldStopPropagation(){return ke(this,U)}constructor(s,a,o,f){Ke(this,U,{writable:!0,value:void 0}),q(this,U,!0);var p;let v=(p=f==null?void 0:f.target)!==null&&p!==void 0?p:o.currentTarget;const d=v==null?void 0:v.getBoundingClientRect();let T,E=0,I,b=null;o.clientX!=null&&o.clientY!=null&&(I=o.clientX,b=o.clientY),d&&(I!=null&&b!=null?(T=I-d.left,E=b-d.top):(T=d.width/2,E=d.height/2)),this.type=s,this.pointerType=a,this.target=o.currentTarget,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.x=T,this.y=E}}const J=Symbol("linkClicked"),Q="react-aria-pressable-style",Z="data-react-aria-pressable";function De(t){let{onPress:s,onPressChange:a,onPressStart:o,onPressEnd:f,onPressUp:p,onClick:v,isDisabled:d,isPressed:T,preventFocusOnPress:E,shouldCancelOnPointerExit:I,allowTextSelectionOnPress:b,ref:H,...oe}=Ie(t),[le,z]=w.useState(!1),x=w.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:C,removeAllGlobalListeners:R}=ve(),M=h((e,i)=>{let c=x.current;if(d||c.didFirePressStart)return!1;let r=!0;if(c.isTriggeringEvent=!0,o){let l=new D("pressstart",i,e);o(l),r=l.shouldStopPropagation}return a&&a(!0),c.isTriggeringEvent=!1,c.didFirePressStart=!0,z(!0),r}),S=h((e,i,c=!0)=>{let r=x.current;if(!r.didFirePressStart)return!1;r.didFirePressStart=!1,r.isTriggeringEvent=!0;let l=!0;if(f){let n=new D("pressend",i,e);f(n),l=n.shouldStopPropagation}if(a&&a(!1),z(!1),s&&c&&!d){let n=new D("press",i,e);s(n),l&&(l=n.shouldStopPropagation)}return r.isTriggeringEvent=!1,l}),L=h((e,i)=>{let c=x.current;if(d)return!1;if(p){c.isTriggeringEvent=!0;let r=new D("pressup",i,e);return p(r),c.isTriggeringEvent=!1,r.shouldStopPropagation}return!0}),m=h(e=>{let i=x.current;if(i.isPressed&&i.target){i.didFirePressStart&&i.pointerType!=null&&S(k(i.target,e),i.pointerType,!1),i.isPressed=!1,i.isOverTarget=!1,i.activePointerId=null,i.pointerType=null,R(),b||j(i.target);for(let c of i.disposables)c();i.disposables=[]}}),V=h(e=>{I&&m(e)}),F=h(e=>{v==null||v(e)}),N=h((e,i)=>{if(v){let c=new MouseEvent("click",e);$e(c,i),v(ye(c))}}),fe=w.useMemo(()=>{let e=x.current,i={onKeyDown(r){if(B(r.nativeEvent,r.currentTarget)&&g(r.currentTarget,$(r.nativeEvent))){var l;ee($(r.nativeEvent),r.key)&&r.preventDefault();let n=!0;if(!e.isPressed&&!r.repeat){e.target=r.currentTarget,e.isPressed=!0,e.pointerType="keyboard",n=M(r,"keyboard");let u=r.currentTarget,y=P=>{B(P,u)&&!P.repeat&&g(u,$(P))&&e.target&&L(k(e.target,P),"keyboard")};C(K(r.currentTarget),"keyup",Ee(y,c),!0)}n&&r.stopPropagation(),r.metaKey&&Y()&&((l=e.metaKeyEvents)===null||l===void 0||l.set(r.key,r.nativeEvent))}else r.key==="Meta"&&(e.metaKeyEvents=new Map)},onClick(r){if(!(r&&!g(r.currentTarget,$(r.nativeEvent)))&&r&&r.button===0&&!e.isTriggeringEvent&&!O.isOpening){let l=!0;if(d&&r.preventDefault(),!e.ignoreEmulatedMouseEvents&&!e.isPressed&&(e.pointerType==="virtual"||Te(r.nativeEvent))){let n=M(r,"virtual"),u=L(r,"virtual"),y=S(r,"virtual");F(r),l=n&&u&&y}else if(e.isPressed&&e.pointerType!=="keyboard"){let n=e.pointerType||r.nativeEvent.pointerType||"virtual";l=S(k(r.currentTarget,r),n,!0),e.isOverTarget=!1,F(r),m(r)}e.ignoreEmulatedMouseEvents=!1,l&&r.stopPropagation()}}},c=r=>{var l;if(e.isPressed&&e.target&&B(r,e.target)){var n;ee($(r),r.key)&&r.preventDefault();let y=$(r),P=g(e.target,$(r));S(k(e.target,r),"keyboard",P),P&&N(r,e.target),R(),r.key!=="Enter"&&X(e.target)&&g(e.target,y)&&!r[J]&&(r[J]=!0,O(e.target,r,!1)),e.isPressed=!1,(n=e.metaKeyEvents)===null||n===void 0||n.delete(r.key)}else if(r.key==="Meta"&&(!((l=e.metaKeyEvents)===null||l===void 0)&&l.size)){var u;let y=e.metaKeyEvents;e.metaKeyEvents=void 0;for(let P of y.values())(u=e.target)===null||u===void 0||u.dispatchEvent(new KeyboardEvent("keyup",P))}};if(typeof PointerEvent<"u"){i.onPointerDown=n=>{if(n.button!==0||!g(n.currentTarget,$(n.nativeEvent)))return;if(ge(n.nativeEvent)){e.pointerType="virtual";return}e.pointerType=n.pointerType;let u=!0;if(!e.isPressed){e.isPressed=!0,e.isOverTarget=!0,e.activePointerId=n.pointerId,e.target=n.currentTarget,b||xe(e.target),u=M(n,e.pointerType);let y=$(n.nativeEvent);"releasePointerCapture"in y&&y.releasePointerCapture(n.pointerId),C(K(n.currentTarget),"pointerup",r,!1),C(K(n.currentTarget),"pointercancel",l,!1)}u&&n.stopPropagation()},i.onMouseDown=n=>{if(g(n.currentTarget,$(n.nativeEvent))&&n.button===0){if(E){let u=be(n.target);u&&e.disposables.push(u)}n.stopPropagation()}},i.onPointerUp=n=>{!g(n.currentTarget,$(n.nativeEvent))||e.pointerType==="virtual"||n.button===0&&L(n,e.pointerType||n.pointerType)},i.onPointerEnter=n=>{n.pointerId===e.activePointerId&&e.target&&!e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!0,M(k(e.target,n),e.pointerType))},i.onPointerLeave=n=>{n.pointerId===e.activePointerId&&e.target&&e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!1,S(k(e.target,n),e.pointerType,!1),V(n))};let r=n=>{if(n.pointerId===e.activePointerId&&e.isPressed&&n.button===0&&e.target){if(g(e.target,$(n))&&e.pointerType!=null){let u=!1,y=setTimeout(()=>{e.isPressed&&e.target instanceof HTMLElement&&(u?m(n):(te(e.target),e.target.click()))},80);C(n.currentTarget,"click",()=>u=!0,!0),e.disposables.push(()=>clearTimeout(y))}else m(n);e.isOverTarget=!1}},l=n=>{m(n)};i.onDragStart=n=>{g(n.currentTarget,$(n.nativeEvent))&&m(n)}}return i},[C,d,E,R,b,m,V,S,M,L,F,N]);return w.useEffect(()=>{if(!H)return;const e=K(H.current);if(!e||!e.head||e.getElementById(Q))return;const i=e.createElement("style");i.id=Q,i.textContent=`
@layer {
  [${Z}] {
    touch-action: pan-x pan-y pinch-zoom;
  }
}
    `.trim(),e.head.prepend(i)},[H]),w.useEffect(()=>{let e=x.current;return()=>{var i;b||j((i=e.target)!==null&&i!==void 0?i:void 0);for(let c of e.disposables)c();e.disposables=[]}},[b]),{isPressed:T||le,pressProps:ne(oe,fe,{[Z]:!0})}}function X(t){return t.tagName==="A"&&t.hasAttribute("href")}function B(t,s){const{key:a,code:o}=t,f=s,p=f.getAttribute("role");return(a==="Enter"||a===" "||a==="Spacebar"||o==="Space")&&!(f instanceof W(f).HTMLInputElement&&!ae(f,a)||f instanceof W(f).HTMLTextAreaElement||f.isContentEditable)&&!((p==="link"||!p&&X(f))&&a!=="Enter")}function k(t,s){let a=s.clientX,o=s.clientY;return{currentTarget:t,shiftKey:s.shiftKey,ctrlKey:s.ctrlKey,metaKey:s.metaKey,altKey:s.altKey,clientX:a,clientY:o}}function Ce(t){return t instanceof HTMLInputElement?!1:t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!X(t)}function ee(t,s){return t instanceof HTMLInputElement?!ae(t,s):Ce(t)}const Me=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function ae(t,s){return t.type==="checkbox"||t.type==="radio"?s===" ":Me.has(t.type)}export{De as $};
